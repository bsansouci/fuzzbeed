var BF_LoadContributions=function(){this.number_of_comment_pages;this.paging_count=1;this.is_loaded=false;this.max_pages=4;this.click_load_more_responses=false;this.response_text;this.init=function(){this.response_text="";EventManager.observe("ajax_comments:load",function(){bf_load_contributions.load_list()});EventManager.observe("progressive-load-callback:bf-contributions",function(c){bf_load_contributions.processComments(c)});universal_dom.assign_handler({bucket:"load_contributions",event:"click",handler:bf_load_contributions._load});var b=document.location.href.match("comment=([^&]*)");if(b){bf_load_contributions.load_list();bf_load_contributions.is_loaded=true;$("contribution-list").scrollIntoView();EventManager.observe("ajax_comments:loaded",function(){comment_links.highlite(b[1]);$(b[1]).scrollIntoView();bf_load_contributions.pre_fb_position=document.body.clientHeight-document.documentElement.scrollTop;FB.Event.subscribe("xfbml.render",function(d){var c=document.body.clientHeight-document.documentElement.scrollTop;if(bf_load_contributions.pre_fb_position&&bf_load_contributions.pre_fb_position!=c){$(b[1]).scrollIntoView()}})})}var a=document.location.href.match(/\?responses/);if(a){$("responses").scrollIntoView()}};this.processComments=function(a){EventManager.fire("ajax_comments:load");bf_load_contributions.is_loaded=true;window.clearInterval(a)};this._load=function(){bf_load_contributions.click_load_more_responses=true;if($("contribution-list").select("li")&&!bf_load_contributions.is_loaded){$("contribution-list").select("li").each(function(a){a.remove()})}$("load-contrib-button").addClassName("hidden");EventManager.fire("ajax_comments:load")};this.load_list=function(){var c=new BF_Request();var a;bf_load_contributions.number_of_comment_pages=$F("comments-pages");if(bf_load_contributions.paging_count==1){a=BF_STATIC.web_root+"/_comments/"+BF_STATIC.campaignid}else{if(bf_load_contributions.paging_count<=bf_load_contributions.number_of_comment_pages){a=BF_STATIC.web_root+"/_comments/"+BF_STATIC.campaignid+"/"+bf_load_contributions.paging_count}}var d={};document.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,f,g){d[f]=g});if(d.z){a+="?z="+d.z+"&zz="+d.z}var b=document.location.href.match("comment=([^&]*)");if(bf_load_contributions.paging_count<=bf_load_contributions.number_of_comment_pages){bf_load_contributions.comments_request();c.request(a,{onSuccess:function(e){if(!bf_load_contributions.click_load_more_responses){this.response_text+=e.responseText}else{this.response_text=e.responseText}if(!bf_load_contributions.click_load_more_responses&&bf_load_contributions.paging_count<bf_load_contributions.max_pages&&b&&this.response_text.search(b[1])==-1){bf_load_contributions.paging_count++;if(bf_load_contributions.paging_count<=bf_load_contributions.number_of_comment_pages){a=BF_STATIC.web_root+"/_comments/"+BF_STATIC.campaignid+"/"+bf_load_contributions.paging_count}bf_load_contributions.load_list()}else{bf_load_contributions.set_comments(this.response_text);if(typeof bf_contribute!=undefined){bf_contribute.update_contribs(this.response_text)}bf_load_contributions.end_request();bf_load_contributions.paging_count++;$("load-contrib-button").removeClassName("hidden");EventManager.fire("ajax_comments:loaded")}}})}};this.set_comments=function(c){$("contribution-list").insert(c);var a=(parseInt(bf_load_contributions.number_of_comment_pages)<=bf_load_contributions.paging_count);if(bf_load_contributions.number_of_comment_pages<=1||a){$("load-contributions").addClassName("hidden")}$$(".respond").invoke("observe","click",bf_contribute.observeRespond);var b=$$("a.report-button");b.each(function(d){var e=d.getAttribute("comment_id");if(e){d.observe("click",function(f){f.stop();report_manager.flag_comment(f);return false})}});$$(".vote-love_or_hate").each(function(d){d.observe("click",badge_vote_manager.vote)});$$(".share a").each(function(d){d.observe("click",comment_links.show_share_box)});$$(".comment-share .share-icon").each(function(d){d.observe("click",comment_links.comment_share)});if(acl.user_can("community_manage")||(acl.user_can("partners_manage")&&BF_STATIC.f_ad)){bf_post_tools.init()}bf_editor.init();$("contribution-list").select("img.bf_dom").each(function(d){if(typeof d!=undefined&&d.getAttribute("rel:bf_bucket")=="progload"){bf_prog_load.load_image(d,d.getAttribute("rel:bf_image_src"))}})};this.comments_request=function(){$("comments-spinner").removeClassName("hidden")};this.end_request=function(){$("comments-spinner").addClassName("hidden")}};var bf_load_contributions=new BF_LoadContributions();BuzzLoader.register(bf_load_contributions.init,1);var rwg=new (function(){this.num_shown_images=0;this.num_images=0;this.els={};this.post_params={};this.image_path=BF_STATIC.static_root+"/images/public/react_with_gif/";this.sponsored_gifs=[];this.gifs=["default/cute.gif","default/deal.gif","default/good.gif","default/nope.gif","default/omg.gif","default/yawn.gif","default/lol.gif","default/win.gif","default/fail.gif","default/cool.gif","default/trashy.gif","default/wow.gif","default/wtf.gif","default/wut.gif","default/yaaass.gif"];this.templates={slide:"      <a class='slide' rel:gt_act='ignore'>        {gif_loader}        {gif}        {sponsored_msg}      </a>",gif_loader:"<img class='gif-loader hidden' src='"+BF_STATIC.static_root+"/images/public/react_with_gif/gif-feed_loading.gif'>",gif:"<img class='react-gif bf_dom' onload='rwg.hide_gif_spinner(this)' src='{preview}' gif='{gif}' preview='{preview}' rel:bf_bucket_data=\"{'rwg-modal':{'action':'create','gif':'{gif}','sponsored':{sponsored}},'rwg-animate':{}}\">",modal_template:"    <div id='rwg-modal-wrapper'>      <i id='rwg_spinner' class='fa fa-spinner fa-spin fa-5x hidden'></i>      <img id='rwg-modal-gif' class='bf_dom' src='{gif}' onload=\"rwg.modal({'action':'open','gif':'{gif}'})\">      <a id='rwg-modal-submit' class='button2 bf_dom' rel:gt_act='ignore' rel:bf_bucket_data=\"{'rwg-post':{'gif':'{gif}','sponsored':{sponsored}}}\">Post this GIF as a Reaction</a>      <a id='rwg-modal-close' class='bf_dom' rel:gt_act='ignore' rel:bf_bucket_data=\"{'rwg-modal':{'action':'close','gif':'{gif}'}}\">Cancel</a>    </div>"};this.init=function(g){rwg.els=g.els;universal_dom.assign_handler({bucket:"rwg-modal",event:"click",handler:rwg.modal});universal_dom.assign_handler({bucket:"rwg-animate",event:"mouseover",handler:rwg.animate_gif});universal_dom.assign_handler({bucket:"rwg-animate",event:"mouseout",handler:rwg.show_preview});universal_dom.assign_handler({bucket:"rwg-animate-all",event:"mouseover",handler:rwg.animate_all_gifs});universal_dom.assign_handler({bucket:"rwg-animate-all",event:"mouseout",handler:rwg.stop_all_animations});universal_dom.assign_handler({bucket:"rwg-post",event:"click",handler:rwg.post_gif_as_reaction});universal_dom.assign_handler({bucket:"gif-nav",event:"click",handler:rwgCarousel.start});universal_dom.assign_handler({bucket:"rwg-toggle",event:"click",handler:rwgCarousel.toggle});rwg.num_images=(rwg.gifs.length+rwg.sponsored_gifs.length);for(var d=0;d<rwg.num_images;d++){var f,c,b,e=false;if(rwg.sponsored_gifs.length>0&&((d+1)%5)==0){e=true;var a=rwg.randomNum(0,(rwg.sponsored_gifs.length-1));gif_src=rwg.image_path+rwg.sponsored_gifs[a];preview_src=gif_src.replace(".gif",".jpg");rwg.sponsored_gifs=rwg.sponsored_gifs.remove(rwg.sponsored_gifs[a])}else{if(rwg.gifs.length){gif_src=rwg.image_path+rwg.gifs.shift();preview_src=gif_src.replace(".gif",".jpg")}}if(gif_src&&preview_src){c=rwg.templates.gif.replaceAll("{preview}",preview_src).replaceAll("{gif}",gif_src).replaceAll("{id}",d).replaceAll("{sponsored}",e);b=rwg.templates.slide.replaceAll("{gif_loader}",rwg.templates.gif_loader).replaceAll("{gif}",c).replaceAll("{sponsored_msg}",(e?rwg.templates.sponsored_msg:""));rwg.els.image_wrapper.insert(b)}}universal_dom.update(rwg.els.image_wrapper);if($.jStorage.get("rwg-toggle")=="open"){rwgCarousel.toggle(1)}};this.modal=function(b){var a=typeof b.gif!="undefined"?b.gif:null;if(b.action=="create"){rwg.els.wrapper.style.overflow="visible";rwg.els.modal.innerHTML=rwg.templates.modal_template.replaceAll("{gif_loader}",rwg.templates.gif_loader).replaceAll("{gif}",a).replaceAll("{sponsored}",b.sponsored);universal_dom.update(rwg.els.modal)}else{if(b.action=="open"){rwg.els.modal.removeClassName("hidden");gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-modal-impression",rwg.cleanGifName(a))}else{if(b.action=="close"||b.action=="destroy"){rwg.els.wrapper.style.overflow="hidden";rwg.els.modal.addClassName("hidden");rwg.els.modal.innerHTML="";if(b.action=="close"){gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-modal-cancel",rwg.cleanGifName(a))}}}}};this.cleanGifName=function(b){try{return b.replaceAll(rwg.image_path,"")}catch(a){return b}};this.animate_gif=function(c){var a=$(c.element);var b=a.siblings(".gif-loader").first();rwg.stop_all_animations();a.src=a.readAttribute("gif");rwg.show_gif_spinner(a)};this.hide_gif_spinner=function(a){if($(a)){var b=$(a).siblings(".gif-loader").first();if(b){if((/\.(gif)$/i).test($(a).src)){$(a).setAttribute("loaded","true");window.setTimeout(function(){if(!b.hasClassName("hidden")){b.addClassName("hidden")}},350)}else{if(!b.hasClassName("hidden")){b.addClassName("hidden")}}}}};this.show_gif_spinner=function(a){if($(a)&&(/\.(gif)$/i).test($(a).src)&&$(a).getAttribute("loaded")!="true"){var b=$(a).siblings(".gif-loader").first();if(b){window.setTimeout(function(){if(b.hasClassName("hidden")){b.removeClassName("hidden")}window.setTimeout(function(){rwg.hide_gif_spinner(a)},1000)},100)}}};this.show_preview=function(b){var a=$(b.element);a.src=a.readAttribute("preview")};this.stop_all_animations=function(){$(rwg.els.image_wrapper).select(".slide img.react-gif").each(function(a){if(a.hasAttribute("preview")&&a.src!=a.readAttribute("preview")){a.src=a.readAttribute("preview")}})};this.animate_all_gifs=function(){$(rwg.els.image_wrapper).select(".slide img.react-gif").slice(rwg.num_shown_images,rwg.num_shown_images*2).each(function(a){if(a.hasAttribute("gif")&&a.src!=a.readAttribute("gif")){a.src=a.readAttribute("gif")}rwg.show_gif_spinner(a)});gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-button-hover","")};this.post_gif_as_reaction=function(f){var b=new BF_User();var d=f.gif;if(!b.isLoggedIn()){bf_login.loggedInCallbacks=[];bf_login.loggedInCallbacks.push(function(){signin.close();rwg.spinner(1);rwg.post_gif_as_reaction(f)});bf_login.args={no_reload:true,current_page:"signin_anywhere"};signin.open({signin_type:"initial",close_enabled:true});gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-login",rwg.cleanGifName(f.gif));return false}rwg.spinner(1);rwg.post_params={form:"react_image",buzz_id:BF_STATIC.campaignid,parent_id:0,blurb:f.sponsored?rwg.templates.sponsored_blurb:"",url:"/static"+f.gif.replace(BF_STATIC.static_root,""),thumb:"/static"+f.gif.replace(BF_STATIC.static_root,""),height:605,width:605,react_wtih_gif:true,delete_images:"no",};var c={method:"post",parameters:rwg.post_params,onSuccess:rwg.post_success,evalJSON:"force"};var a=b.getUserInfo();if(a.username){c.needsToken=true}bf_contribute.previewFromServer(Object.clone(rwg.post_params));if($("image-preview")){$("image-preview").src=rwg.post_params.thumb}var e=new BF_Request();e.request("/buzzfeed/_commentribute",c);gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-submit",rwg.cleanGifName(f.gif))};this.spinner=function(a){if($("rwg_spinner")){rwg.els.spinner=$("rwg_spinner")}else{return false}if(a){if(rwg.els.spinner.hasClassName("hidden")){rwg.els.spinner.removeClassName("hidden")}}else{if(!rwg.els.spinner.hasClassName("hidden")){rwg.els.spinner.addClassName("hidden")}}};this.post_success=function(a){rwg.spinner(0);rwg.modal({action:"destroy"});bf_contribute.params={};bf_contribute.params=rwg.post_params;bf_contribute._response(a);document.fire("contribute:postitOk")};this.randomNum=function(b,a){return Math.floor(Math.random()*(a-b+1)+b)}})();var rwgCarousel=new (function(){this.els={};this.num_shown_images=0;this.rotate_time=0;this.timer;this.direction;this.init=function(a){rwgCarousel.els={toggle:a.toggle,wrapper:a.wrapper,carousel:a.carousel,modal:a.modal,image_wrapper:a.image_wrapper};rwgCarousel.num_shown_images=a.num_shown_images;rwgCarousel.rotate_time=a.rotate_time;rwg.init({els:rwgCarousel.els,num_shown_images:rwgCarousel.num_shown_images,})};this.toggle=function(b){var a=rwgCarousel.els.wrapper.hasClassName("open")?"closed":"open";if(b===0){a="closed"}else{if(b===1){a="open"}}$(rwgCarousel.els.wrapper).removeClassName("closed").removeClassName("open").addClassName(a);$(rwgCarousel.els.toggle).removeClassName("closed").removeClassName("open").addClassName(a);$.jStorage.set("rwg-toggle",a)};this.start=function(a){rwgCarousel.direction=a.dir;rwgCarousel.els.carousel.className=("move-"+rwgCarousel.direction);rwgCarousel.timer=setTimeout(function(){window.clearTimeout(rwgCarousel.timer);rwgCarousel.stop()},rwgCarousel.rotate_time)};this.stop=function(){var a=$(rwgCarousel.els.image_wrapper).select(".slide");if(rwgCarousel.direction=="left"){a.slice(0,rwgCarousel.num_shown_images).each(function(b){rwgCarousel.els.image_wrapper.insert({bottom:$(b)})})}else{a.slice((a.length-rwgCarousel.num_shown_images),a.length).reverse().each(function(b){rwgCarousel.els.image_wrapper.insert({top:$(b)})})}rwgCarousel.els.carousel.className=""}})();BreakingTime=function(){this.updateBreakingTime=function(b){var f=b;b=b.replace(/-/g,"/");var g=new Date(b),h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],e=g.getHours()>12?true:false,c=(g.getMinutes()<10?"0":"")+g.getMinutes();if(!isNaN(g.getTime())){f=(e?(g.getHours()-12):g.getHours())+":"+c+" "+(e?"p.m.":"a.m.")+" ET, "+a[g.getMonth()]+" "+g.getDate()}return f}};var breaking_time=new BreakingTime();var BF_LF_image_bleed=function(d){this.BLEED_BLOCK_SELECTOR=".buzz_superlist_item_image.image_lffw";this.BLEED_CONTENT_SELECTOR=".sub_buzz_content";this.BLEED_DEBOUNCE_DELAY=400;Object.extend(this,d);var e=[];var a=function(f){e.each(function(h){if(h.original_width>f){h.subbuzz.removeClassName("image_lffw_bled");h.bleed_element.writeAttribute("style","")}else{var g=h.subbuzz.viewportOffset().left?h.subbuzz.viewportOffset().left:0;h.subbuzz.addClassName("image_lffw_bled");h.bleed_element.setStyle({marginLeft:-g+"px",width:f+"px",height:"auto"})}})};var c=BF_UTIL.debounce(a,this.BLEED_DEBOUNCE_DELAY);var b=this;b.initialized=false;this.init=function(){var f=$$(b.BLEED_BLOCK_SELECTOR);var g=document.viewport.getWidth();if(!f.length){return}else{f.each(function(h){if(h.hasClassName("been_bled")){return true}h.addClassName("been_bled");e.push({subbuzz:h,bleed_element:h.select(b.BLEED_CONTENT_SELECTOR).first(),original_width:h.getWidth(),})});a(g);if(!b.initialized){Event.observe(window,"resize",function(){var h=document.viewport.getWidth();c(h);EventManager.fire("BF_LF_image_bleed:resized")})}}b.initialized=true}};BF_LF_image_bleed.prototype={constructor:BF_LF_image_bleed};var bf_lf_image_bleed=new BF_LF_image_bleed();bfjs.onPageLoad(bf_lf_image_bleed.init);var SwitchTrendingTab=function(){this.init=function(){universal_dom.assign_handler({bucket:"switch_trending_tab",handler:this.switchTab.bind(this),event:"click"})};this.switchTab=function(d){var a=d.tab;var c=d.target;if(c.hasClassName("active-tab")){return}$$(".trending-tab").each(function(e){e.removeClassName("active-tab")});c.addClassName("active-tab");$$(".trending-posts").each(function(e){e.addClassName("hidden")});var b=$$(".trending-posts-"+a);if(b.length){b[0].removeClassName("hidden")}}};BuzzLoader.register(function(){var a=new SwitchTrendingTab();if(BF_STATIC.tt_page=="Trending"){a.init()}},1);bf_vote_manager=function(){this.ERR="Sorry, we're unable to process your request at this time. Please try again later.";this.VOTE_UPDATED="Your vote has been counted.";this.ALREADY_VOTED="You've Already Voted!";this.init=function(){var a=$$("a.vote-button");a.each(function(b){var c=b.getAttribute("contributionid");if(c){b.observe("click",function(d){d.stop();vote_manager.handle_click(d);return false})}})};this.handle_click=function(c){var b=c.element();var a=new BF_User();if(a.isLoggedIn()){this.vote(b)}else{this.login(b)}};this.vote=function(a){var b=a.getAttribute("contributionid");this._vote(a,b)};this._vote=function(b,g){try{if(b==null){b=$("vote-button-"+g)}var d={contributionid:g,username:$F("contribute-username"),uri:$F("contribute-uri")};var a=function(e){this.vote_success(b,e)}.bind(this);var f=function(e){this.error(b,e)}.bind(this);new Ajax.Request("/buzzfeed/_vote",{method:"get",parameters:d,onSuccess:a,onFailure:f});this.contribution_id=null}catch(c){this.contribution_id=null;console.error(c)}};this.vote_success=function(e,f){var b=f.responseText.evalJSON();if(!b.updated){this.duplicate_vote(e,b)}else{e.className="voted";e.innerHTML="Voted!";var g=e.getAttribute("contributionid");var d=$("vote_tally_"+g).getAttribute("tally");var a=parseInt(d)+1;var c=a==1?"":"s";$("vote_tally_"+g).update(a+" Vote"+c)}};this.duplicate_vote=function(b,a){b.className="voted";b.innerHTML=this.ALREADY_VOTED};this.error=function(a){}};vote_manager=new bf_vote_manager();BuzzLoader.register(vote_manager.init,1);var BF_InlineSharing=function(){var i=this,g=window,r=document,a=r.viewport,l=BF_UTIL.browser.dimensions,o=function(d){return +d.match(/\d+/)},c=$$(".buzz").first(),q=$$(".PageContainer").first(),b=document.body.textContent?"textContent":"innerText",m=1200,k=function(d){return d.className.match("arrow")},p=function(d){return d===i.shareMenu||d.ancestors().indexOf(i.shareMenu)>=0},f=function(){if(!i.visible){return}var t=Math.round(l.height()/2)-Math.round(i.iconSize/2),d=c.cumulativeOffset().left+15;i.shareIconWrp.setStyle({top:t+"px",left:d+"px"})},j=function(){if(i.shareMenu.hasClassName("hidden")){return}var w=0,u=0,t=10,d=i.shareIconWrp.cumulativeOffset(),v=BF_cumulativeScrollOffset(i.shareIconWrp);w=i.shareMenu.getHeight()+t;u=Math.round((i.shareMenu.getWidth()-i.iconSize)/2);i.shareMenu.setStyle({top:(v.top+d.top-w)+"px",left:(v.left+d.left-u)+"px"})},h=function(){i.shareIconWrp.addClassName("hover");i.shareMenu.removeClassName("hidden");j()},s=function(t){i.shareIconWrp.removeClassName("hover");var d;if(t&&t.type!="click"){d=t.toElement?t.toElement:t.relatedTarget;if(d&&(k(d)||p(d))){return}}i.shareMenu.addClassName("hidden");bpage.hide_all_popups()},e=function(){i.visible=true;f();i.shareIconWrp.removeClassName("hidden")},n=function(){i.visible=false;i.shareIconWrp.addClassName("hidden");s()};i.visible=false;i.iconSize=0;i.type="article";i.init=function(){try{var F,w,z=0,t=$$(".suplist_article").length>0,C=$$(".buzz_superlist_item"),A=C.length?C[0].hasClassName("buzz_superlist_item_wide"):false,E=A?$$(".buzz_superlist_item_wide img"):null,x=$$(".upper-share-buttons"),v=$$(".bottom_shares").first(),D=0;if(v){D=v.cumulativeOffset().top}var B=function(){if($$(".bottom_shares").length&&(!D||v.cumulativeOffset().top!=D)){D=$$(".bottom_shares").first().cumulativeOffset().top}if(x.length&&!z){z=x.first().getHeight()+x.first().cumulativeOffset().top}var H=l.height(),G=a.getScrollOffsets().top+H;if(!i.visible&&a.getScrollOffsets().top>=z&&G<D){e()}else{if(i.visible&&(G<(z+H)||G>=D)){n()}}if(!i.visible){return}j()},d=function(){window.clearTimeout(w);window.clearTimeout(F)},u=function(){var G=0;$("buzz_sub_buzz").select("p").each(function(H){G+=H[b].split(/\s+/).length});return G>=m};i.shareIconWrp=$("inline_share_icon_wrp");if(!i.shareIconWrp){return}i.shareIcons=$$(".inline_share_icon");i.shareMenu=$("inline_shares_box");i.iconSize=o(i.shareIcons.first().getStyle("width"));if(!t){i.type="longform"}else{if(!u()){return}}if(A&&E&&E.length){E=E.first();z=E.getHeight()+E.cumulativeOffset().top}else{x.each(function(G){if(G.getHeight()){z=G.getHeight()+G.cumulativeOffset().top}})}if(!q.hasClassName("ie7")&&!q.hasClassName("ie8")){i.shareIconWrp.addClassName("hoverable")}i.shareIcons.each(function(G){G.on("mouseover",function(){d();h()})});i.shareIcons.each(function(G){G.on("mouseout",function(){F=window.setTimeout(s,1000)})});i.shareMenu.on("mouseover",d);i.shareMenu.on("mouseout",function(){w=window.setTimeout(s,1000)});i.shareMenu.select("a").each(function(G){if(!G.hasClassName("email_icon")){G.on("click",s)}});Event.observe(g,"resize",function(){f();j()});Event.observe(g,"scroll",B);EventManager.observe("sel:showShares",h);B()}catch(y){console.error(y)}}};var BF_KeyControls=function(){this.scroll=null;this.commands=[];this.debug=false;this.matches=function(b,a){if(!!!a.keys.include(b.which)){return false}if((!a.alt&&!!b.altKey)||(!!a.alt&&!b.altKey)){return false}if((!a.ctrl&&!!b.ctrlKey)||(!!a.ctrl&&!b.ctrlKey)){return false}if((!a.shift&&!!b.shiftKey)||(!!a.shift&&!b.shiftKey)){return false}if((!a.cmd&&!!b.metaKey)||(!!a.cmd&&!b.metaKey)){return false}return true};this.init=function(){if(!!this.debug){document.observe("keydown",function(a){console.log("Key: "+(Prototype.Browser.IE?a.keyCode:a.which));console.log(a);return true})}if(this.scroll){this.scroll.slides=$$(this.scroll.items);if(this.scroll.reject_items&&this.scroll.reject_items.length>0){this.scroll.slides=this.scroll.slides.reject(function(b){var a=false,d=b.className.split(" ");d.each(function(c){if(this.scroll.reject_items.include(c)){a=true}}.bind(this));if(b.id&&!!this.scroll.reject_items.include(b.id)){a=true}return a}.bind(this))}if(this.scroll.slides.length>0){if(!this.scroll.keys_up){this.scroll.keys_up=[75,37]}if(!this.scroll.keys_down){this.scroll.keys_down=[74,39]}this.scroll.start_height=this.scroll.slides[0].cumulativeOffset().top;document.observe("keydown",this._scroll.bind(this))}}this.commands.each(function(b,a){if(!b.keys){return}document.observe("keydown",function(f){var c=(Prototype.Browser.IE?f.srcElement:f.target);if(c!=document.body&&c!=$$("html").first()){return true}if(Prototype.Browser.IE){f.which=f.keyCode}if(!!(new BF_KeyControls()).matches(f,this)){if(this._track&&this._track!=""&&!this._track_use){var g=(this.name&&!this.name==""?this.name:this.keys.join(","));gtrack.track_events(this._track,"click:keycontrol",g,true);this._track_use=true}if(this.target){var d=$(this.target);if(d){d.scrollTo()}}if(typeof(this.run)=="function"){this.run()}}return true}.bind(b))})};this._scroll=function(d){if(this.scroll.slides.length<1){return true}var b=(Prototype.Browser.IE?d.srcElement:d.target);if(b!=document.body&&b!=$$("html").first()){return true}if(Prototype.Browser.IE){d.which=d.keyCode}var a=(!!(new BF_KeyControls()).matches(d,{keys:this.scroll.keys_up})),f=(!!(new BF_KeyControls()).matches(d,{keys:this.scroll.keys_down}));if(a||f){if(this.scroll._track&&this.scroll._track!=""&&!this.scroll._track_use){gtrack.track_events(this.scroll._track,"click:keycontrol","scroll",true);this.scroll._track_use=true}this.scroll.position=this.scroll.slides.length-1;if($$("body").first().cumulativeScrollOffset().top>=this.scroll.start_height){this.scroll.slides.each(function(g,e){if(a&&g.viewportOffset().top>=0){this.scroll.position=e-1;throw $break}else{if(f&&g.viewportOffset().top>0){this.scroll.position=e;throw $break}}}.bind(this))}else{this.scroll.position=0}if(this.scroll.position>=-1&&this.scroll.position<this.scroll.slides.length){if(typeof(this.scroll.onbefore)=="function"){this.scroll.onbefore(d)}if(typeof(this.scroll.onafter)=="function"){this.scroll.onafter(d)}var c=$(this.scroll.slides[this.scroll.position]);if(c){$(c).scrollTo()}return false}}}};BF_sub_links=function(){this.sub_id;this.page_url;var a;this.init=function(){if(BF_STATIC.bf_test_mode&&(!EventManager.eventStack["sharing:comment:done"]||EventManager.eventStack["sharing:comment:done"].length!=test_subbuzz_shares_count)){setTimeout(sub_links.init,100);return false}if(BF_STATIC.referer=="pinterest.com"||document.referrer.match("https?://(?:www.)?pinterest.com/")){a=true}universal_dom.assign_handler({bucket:"fb-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"tw-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"link-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"pin-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"response-share",handler:sub_links.response_share,event:"click"});universal_dom.assign_handler({bucket:"email-share",handler:sub_links.sub_share,event:"click"});if(document.URL.include("?sub")){var b=document.URL.toQueryParams();sub_links.sub_id=b.sub}if(sessionStorage[sub_links.sub_id]){sessionStorage[sub_links.sub_id]=false}document.observe("scroll",sub_links.hide_link);document.observe("click",sub_links.click_hide);sub_links.process_URL();sub_links.set_share_box();sub_links.pinterest_inapp();if(!a&&$$(".share-box")&&$$(".share-box").length>0){Event.observe(window,"scroll",function(c){sub_links.share_buddy()})}sub_links.share_box_hover_fix();sub_links.share_box_position_fix()};this.share_box_hover_fix=function(){if(isMSIE()){$$(".buzz_superlist_item").each(function(b){b.observe("mouseover",function(){b.addClassName("hover")}).observe("mouseout",function(){b.removeClassName("hover")})})}};this.share_box_position_fix=function(){Element.observe(window,"resize",function(){b()});b();function b(){if($$(".share-box").length>0){$$(".share-box").each(function(c){c.removeClassName("share-box-reset-left");if(typeof c.viewportOffset=="function"&&c.viewportOffset().left<0){c.addClassName("share-box-reset-left")}})}}};this.share_box_inactive=function(b){if($$(".share-box").length>0){$$(".share-box").each(function(c){if(typeof b=="undefined"||b!=c){c.removeClassName("share-email-active")}})}};this.process_URL=function(){if(document.URL.include("sub")){var e=document.URL.toQueryParams();sub_links.sub_id=e.sub;if(typeof sub_links.sub_id!="undefined"){var b=$("superlist_"+sub_links.sub_id);var d=b.getHeight();sub_links.sub_scroll(b);sessionStorage[sub_links.sub_id]=true;$(b).addClassName("current_buzz");var c=function(){b.addClassName("current_buzz_reset")};c.delay(2)}}};this.get_sub_id=function(c){var b="";if(c.include("_")){b=c.split("_")[1]}return b};this.get_url=function(c){var b=document.URL;if(b.include("?")){b=b.split("?")[0]}if(b.include("#")){b=b.split("#")[0]}sub_links.page_url=b;if(c){b=b+"?sub="+c}if(typeof BF_STATIC.pound_enabled!="undefined"&&BF_STATIC.pound_enabled&&!BF_STATIC.mobile_app){if(c){b=pound.urls.unescaped.queryStringOnly([],[["sub",c]])}else{b=pound.urls.unescaped.queryStringOnly()}sub_links.page_url=b}return b};this.get_buzz_title=function(){var b="";if($$('meta[name="title"]').length>0&&$$('meta[name="title"]')[0].attributes.content.value){b=$$('meta[name="title"]')[0].attributes.content.value}else{if($$('meta[property="og:title"]').length>0&&$$('meta[property="og:title"]')[0].attributes.content.value){b=$$('meta[property="og:title"]')[0].attributes.content.value}else{if($("post-title")){b=$("post-title").innerHTML.replaceAll("&nbsp;"," ")}}}return b?b.unescapeHTML().stripTags().trim():""};this.sub_share=function(p){sub_links.sub_id=p.id;var h=sub_links.get_url(p.not_a_sub?null:p.id);var s=$("superlist_"+p.id);var d,C,g=s;var x;if(p.element.hasClassName("sub-buzz-facebook-share")&&p.element.getAttribute("rel:description")){x=p.element.getAttribute("rel:description")}else{if($$('meta[property="og:description"]').length>0){x=$$('meta[property="og:description"]')[0].attributes.content.value}else{x=""}}if(p.element.getAttribute("rel:sub_title")!=null){C=p.element.getAttribute("rel:sub_title")}if($$('meta[property="og:title"]').length>0&&$$('meta[property="og:title"]')[0].attributes.content.value!=""){var n=$$('meta[property="og:title"]')[0].attributes.content.value}if(!C){C=n}var k=p.element.getAttribute("rel:adtl_tweet_text")?p.element.getAttribute("rel:adtl_tweet_text"):"";var r=p.element.getAttribute("rel:hashtags")?p.element.getAttribute("rel:hashtags"):"";var w=p.element.getAttribute("rel:via")?p.element.getAttribute("rel:via"):"";var d=new Array();var B=$$('meta[property="og:image"]')[0].attributes.content.value;if(B.length&&B[0]=="/"){B=BF_STATIC.big_image_root+B}if($(s).hasClassName("buzz_superlist_item_image")||($(s).hasClassName("buzz_superlist_item_video")&&$(s).hasClassName("video_instagram"))){$("superlist_"+p.id).select(".sub_buzz_content img").each(function(t){if(typeof t.up(".catcha_service")!="undefined"){return}d.push(t)})}else{if($(s).hasClassName("buzz_superlist_item_video")&&!$(s).hasClassName("video_instagram")){$("superlist_"+p.id).select(".sub_buzz_content .video-embed-area").each(function(t){d.push(t)})}else{if($(s).hasClassName("buzz_superlist_item_grid_row")){$("superlist_"+p.id).select(".grid_cell img").each(function(t){if(typeof t.up(".catcha_service")!="undefined"){return}d.push(t)})}else{if(s.hasClassName("buzz_superlist_item_photoslider")){var m=s.select(".photoslider_left_image img",".photoslider_right_image img");d=d.concat(m)}else{if($(s).hasClassName("buzz_superlist_item_update")){var l=$("update_item_"+p.id);$(l).select(".sub_buzz_content img").each(function(t){if(typeof t.up(".catcha_service")!="undefined"){return}d.push(t)});$(l).select(".sub_buzz_content embed").each(function(t){d.push(t)});$(l).select(".buzz_superlist_item_grid_row .grid_cell img").each(function(t){if(typeof t.up(".catcha_service")!="undefined"){return}d.push(t)})}}}}}if(g&&g.select("h2").length>0){C=g.select("h2")[0].innerHTML.unescapeHTML().stripTags().trim()}if(p.element.hasClassName("sub-buzz-facebook-share")){if(BF_STATIC.vertical=="style"){sharing.buttons._custom_audience_fb("facebook")}h=encodeURIComponent(h);C=encodeURIComponent(C);x=encodeURIComponent(x);r=encodeURIComponent(r);k=encodeURIComponent(k);w=encodeURIComponent(w);var j="";d.each(function(D,t){if(!j){j=encodeURIComponent(D.readAttribute("rel:bf_image_src"))}});if(!j){j=encodeURIComponent(B)}var A=(BF_STATIC.bf_env=="dev"?"http://dev.buzzfeed.com/":BF_STATIC.bf_env=="stage"?"http://stage.buzzfeed.com/":BF_STATIC.bf_env=="live"?"http://buzzfeed.com/":"")+"static/html/timemachine_share.html";window.open("https://www.facebook.com/dialog/feed?display=popup&app_id="+BF_STATIC.fb_app_id+"&link="+h+"&picture="+j+"&name="+C+"&description="+x+"&redirect_uri="+A,"_blank","width=600, height=260");sub_links.hide_link(p.id,false);fbSharePixel()}else{if(p.element.hasClassName("sub-buzz-twitter-share")){if(BF_STATIC.vertical=="style"){sharing.buttons._custom_audience_fb("twitter")}C=encodeURIComponent(C.trim());k=encodeURIComponent(k);r=encodeURIComponent(r);w=encodeURIComponent(w);h=encodeURIComponent(h);window.open("https://twitter.com/intent/tweet?text="+C+k+"&hashtags="+r+(w?"&via="+w:"")+"&url="+h,"_blank","width=600,height=400");sub_links.hide_link(p.id,false)}else{if(p.element.hasClassName("sub-buzz-link-share")){var v=$(p.element).offsetTop;$(s).select(".copy-link").each(function(t){$(t).remove()});$(s).select(".share-box").each(function(D){if($(s).hasClassName("buzz_superlist_item_video")&&!$(s).hasClassName("video_instagram")){$(D).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:250px; left: 70px; padding:5px;font-size:14px;" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>');if($(D).select(".copy-link").length){$(D).select(".copy-link")[0].setStyle({top:(v+10)+"px"})}}else{if($(s).hasClassName("buzz_superlist_item_update")){$(D).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:7px; left: 335px; padding:5px;font-size:14px;z-index:99" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>')}else{$(D).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:250px; left: 70px; padding:5px;font-size:14px;" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>');if($(D).select(".copy-link").length){$(D).select(".copy-link")[0].setStyle({top:(v+10)+"px"})}}}sub_links.hide_link(p.id,true);var t=Selector.findChildElements(D,[".copy-link-input"])[0];t.select()})}else{if(p.element.hasClassName("sub-buzz-pinterest-share")){if(BF_STATIC.vertical=="style"){sharing.buttons._custom_audience_fb("pinterest")}var z=encodeURIComponent(h);var c="";if(d.length<=1){var b;if(d.length==0){b=B}else{b=d[0].readAttribute("rel:bf_image_src")||d[0].readAttribute("rel:thumb")}b=encodeURIComponent(b);var o=Prototype.Browser.IE?636:336;if(p.element.up(".buzz_superlist_item").select("h2").length){var y=Element.clone(p.element.up(".buzz_superlist_item").select("h2")[0],true);if(y.select("span.buzz_superlist_number_inline").length){y.select("span.buzz_superlist_number_inline")[0].remove()}c=y.innerHTML.unescapeHTML().stripTags().trim()}if(n){c=c?c+" | "+n:n}c=encodeURIComponent(c);window.open("http://pinterest.com/pin/create/button/?media="+b+"&url="+z+"&description="+c,"_blank","width=600,height="+o);sub_links.hide_link(p.id,false)}else{var i=$(document.viewport).getScrollOffsets().top;window.scrollTo(0,0);var e=BF_UTIL.document.height();$("pin_bg").setStyle({height:e+"px"});$("pin_bd").setStyle({height:e+"px"});if($("pin_img_container").innerHTML){$("pin_img_container").innerHTML=""}document.body.appendChild($("pin_bg").show()).appendChild($("pin_bd").show());var q=$$("#superlist_"+sub_links.sub_id+" img");if($(s).hasClassName("buzz_superlist_item_update")){q=d}if(q.length){q.each(function(G){if(typeof G.up(".catcha_service")!="undefined"){return}c="";var t=document.createElement("SPAN");t.addClassName("pin_image");var F=sub_links.get_natural_img_size(G).width,K=sub_links.get_natural_img_size(G).height,D=200,J=200,H="";if(F>K){D=G.width/(G.height/200);H="margin-left: "+(0-(D-200)/2)+"px"}else{J=G.height/(G.width/200);H="margin-top: "+(0-(J-200)/2)+"px"}var E=G.readAttribute("rel:bf_image_src");if(G.up(".buzz_superlist_item").select("h2").length){var I=Element.clone(G.up(".buzz_superlist_item").select("h2")[0],true);if(I.select("span.buzz_superlist_number_inline").length){I.select("span.buzz_superlist_number_inline")[0].remove()}c=I.innerHTML.unescapeHTML().stripTags().trim()}if(n){c=c?c+" | "+n:n}c=encodeURIComponent(c);t.innerHTML='<span class="pin_img"><img style="'+H+'" src="'+E+'" width="'+D+'px" height="'+J+'px"></span><cite><span class="pin_mask"></span><span>'+F+"x"+K+"</span></cite><a onclick=\"var sTop = window.screen.height/2-(168); var sLeft = window.screen.width/2-(313); window.open(this.href, 'sharer','toolbar=0,status=0,width=626,height=336,top='+sTop+',left='+sLeft); window.scrollTo(0,"+i+'); return false;" href="http://pinterest.com/pin/create/bookmarklet/?url='+z+"&media="+E+"&description="+c+'" target="_blank"></a>';t.select("a")[0].observe("click",function(){if($("pin_bg")){$("pin_bg").hide()}if($("pin_bd")){$("pin_bd").hide()}});$("pin_img_container").appendChild(t)})}}}else{if(p.element.hasClassName("sub-buzz-email-share")){if(BF_STATIC.vertical=="style"){sharing.buttons._custom_audience_fb("email")}$("share_email_error").hide();var h=sub_links.get_url(p.id);var u=$(p.element.id);var f=$(u).up(".share-box");if(typeof f!="undefined"){f.addClassName("share-email-active");sub_links.share_box_inactive(f)}shareEmail.locate_form_and_share_email($(u),p.id);$("sub_buzz_id").value=sub_links.get_sub_id(p.id)}}}}}};this.response_share=function(c){BF_Effect.ScrollIntoView("contribute-box");var b=c.target.getAttribute("rel:count");Form.Element.setValue("text-text","#"+b)};this.hide_link=function(c,b){if($("buzz_sub_buzz")){if(!b){$("buzz_sub_buzz").select(".copy-link").each(function(d){$(d).hide()})}else{$("buzz_sub_buzz").select(".copy-link").each(function(d){$(d).oncopy=function(){BF_Effect.FadeOut(d,0,1)}})}}};this.click_hide=function(c){try{if(typeof(c.target)=="undefined"||!isHTMLElement(c.target)){console.log("Not html element. SVG fix.");return}var b=(c.target.hasClassName("sub-buzz-link-share")||c.target.hasClassName("copy-link")||c.target.parentNode.hasClassName("copy-link"));if(!b){sub_links.hide_link()}}catch(c){console.error(c)}};this.set_share_box=function(){var b=0;var c=new Array();$$(".buzz_superlist_item").each(function(e){if(a){e.addClassName("pin-ref");if(e.hasClassName("buzz_superlist_item_grid_row")){var d=e.select(".share-box")[0];if(e.select(".grid_row")[0]){e.select(".grid_row")[0].insert(d);d.addClassName("pin_grid_share")}}}$(e).select(".share-box").each(function(g){if(e.getHeight()<=250&&!$$("body")[0].hasClassName("list_format_long")){$(g).setStyle({top:"0px"})}});b++;var f=$(e).select(".response-button");f.each(function(g){$(g).removeClassName("hidden");$(g).setAttribute("rel:count",b)})})};this.pinterest_inapp=function(){uagent=navigator.userAgent.toLowerCase();if((uagent.match(/pinterest/)||a)&&uagent.match(/ipad/)){$$("body")[0].addClassName("inapp-pinterest")}else{if(!bfjs.isMobile()&&(a)){$$("body")[0].addClassName("webapp-pin-referer")}}};this.arrow_fade=function(){var b=$("here-arrow");if(typeof b!=null){BF_Effect.FadeOut("here-arrow",0)}};this.sub_scroll=function(b){if(document.loaded){$(b).scrollTo()}};this.get_natural_img_size=function(c){if(isIE7()||isIE8()){var b=new Image();b.src=c.src;return{width:b.width,height:b.height}}else{return{width:c.naturalWidth,height:c.naturalHeight}}};this.share_buddy=function(){try{$$(".buzz_superlist_item_image").each(function(d){var c=d.select("img")[0];if(!c||!c.height){return}var g=c.height;if(g>=550){var f=Element.viewportOffset(d.select("img")[0]).top;var e=d.select(".share-box")[0];if(typeof(e)!="undefined"){if(f<=0&&(f*-1)<=(g-200)){f=f*-1;e.setStyle({top:f+"px"})}else{e.setStyle({top:"0px"})}}}})}catch(b){console.error(b)}}};var sub_links=new BF_sub_links();BuzzLoader.register(sub_links.init,4);var BF_Catcha=function(){this.service_handlers={email_a_friend:shareEmail,rerankable_posts:shareEmail,anonymus_flag_comment:flagComment};this.catcha_answer="";this.draw_catcha=function(a){var b=this.service_handlers[a];if(b){if(typeof b.draw_catcha!="undefined"){b.draw_catcha.call()}else{console.warn("draw_catcha is not defined on the handling object for service "+a)}}else{console.warn("No handler defined for catcha service "+a)}};this.set_image_and_question=function(a){try{a.image_element.setAttribute("src","/buzzfeed/catcha/"+a.service+".jpg?cb="+(new Date()).getTime()+"."+Math.floor(Math.random()*10000));a.image_element.observe("load",function(){a.question_element.update("What is the name of the cat numbered "+readCookie("catcha-"+a.service+"-question")+"?")})}catch(b){console.dir({e:b})}}};bf_catcha=new BF_Catcha();if(typeof draw_catcha_for_service!="undefined"){bf_catcha.draw_catcha(draw_catcha_for_service)}var player_1;var player_2;function onYouTubePlayerAPIReady(a){player_1=new YT.Player("nhl_1",{events:{onReady:d,onStateChange:b}});player_2=new YT.Player("nhl_2",{events:{onReady:c,onStateChange:b}});function d(e){e.target.cuePlaylist({list:"PLCDBC58F5089E5045",index:0,startSeconds:0,suggestedQuality:"large"});gtrack.track_events("Buzz","[nc]playlist:load","stanley-cup-countdown",null,false)}function c(e){e.target.cuePlaylist({list:"PL1F9AA0374C05807A",index:0,startSeconds:0,suggestedQuality:"large"});gtrack.track_events("Buzz","[nc]playlist:load","melroses-place",null,false)}function b(f){var e=f.target.g.playlistIndex;if(e!=-1){var h=f.target.g.playlist[e];var g="http://youtube.com/v/"+h;switch(f.data){case -1:gtrack.track_events("Buzz","[nc]video:load",g,null,true);break;case 0:gtrack.track_events("Buzz","[nc]video:end",g,null,false);break;case 1:gtrack.track_events("Buzz","video-play",g);break}}}}var ageGate=new function(){_ageGate=this;this.els;this.init=function(){universal_dom.assign_handler({bucket:"age_gate_toggle",event:"click",handler:_ageGate.toggle});universal_dom.assign_handler({bucket:"age_gate_toggle",event:"click",handler:_ageGate.toggle})};this.getEls=function(a){_ageGate.els={content:$s("#age_gate_hidden_content_"+a),parent:$s("#age_gate_"+a),no_message:$s("#age_gate_"+a+"_no_message").clone(true).removeClassName("hidden")}};this.toggle=function(a){_ageGate.getEls(a.id);if(a.showContent=="true"){_ageGate.els.content.removeClassName("hidden");_ageGate.els.parent.remove()}else{_ageGate.els.content.remove();_ageGate.els.parent.innerHTML="";_ageGate.els.parent.insert(_ageGate.els.no_message)}}};BuzzLoader.register(ageGate.init,5);var BF_Photoslider=function(){var l=200;var c=3000;var i=0;var h=20;var e;var g=false;this.init=function(){var p=$(document.body);var o=p[bfjs.selector]("#buzz_sub_buzz .photoslider");e=o[0];if(o.length===0){return false}if(!bfjs.isMobile()){bfjs.universal_each(o,function(r,q){m(r)})}else{$(document).on("img-load-complete",function(t){var q=$(t.target);var s=q.closest(".photoslider")[0];var r=$(s);if(r.hasClass("no-img-loaded")){r.removeClass("no-img-loaded").addClass("one-img-loaded")}else{if(r.hasClass("one-img-loaded")){m(s);r.removeClass("one-img-loaded").addClass("photoslider-build-complete");if(BF_STATIC.mobile_app&&BF_STATIC.os=="android"&&g==false){m(o[0])}}}})}};var n=function(p,r,o){var q;return function(){var t=this,s=arguments;clearTimeout(q);q=setTimeout(function(){q=null;if(!o){p.apply(t,s)}},r);if(o&&!q){p.apply(t,s)}}};var b=function(o){var p=o.getBoundingClientRect();return((p.top>=0&&p.top<=(window.innerHeight||document.documentElement.clientHeight))||(p.bottom>=0&&p.bottom<=(window.innerHeight||document.documentElement.clientHeight))||(p.top<0&&p.bottom>(window.innerHeight||document.documentElement.clientHeight)))};var j=function(o){bfjs.universal_each(o,function(p,q){if(b(p)&&!$(p)[bfjs.has_class]("photoslider_in_view")){$(p)[bfjs.add_class]("photoslider_in_view");if(!f(p)){i=setTimeout(function(){$(p)[bfjs.add_class]("photoslider_viewed")},c)}}else{if(!b(p)&&$(p)[bfjs.has_class]("photoslider_in_view")){$(p)[bfjs.remove_class]("photoslider_in_view")}}})};var k=function(o){bfjs.universal_each(o,function(p,q){$(p)[bfjs.add_class]("photoslider_disabled")})};var a=function(o){bfjs.universal_each(o,function(p,q){$(p)[bfjs.remove_class]("photoslider_disabled")})};var f=function(o){return $(o)[bfjs.has_class]("photoslider_viewed")};var m=function(p){var v=$(p);var t=bfjs.isMobile()?v[bfjs.selector](".photoslider_image")[0]:v[bfjs.selector](".photoslider_image_wrapper")[0];var w=bfjs.isMobile()?$(t):$(v[bfjs.selector](".photoslider_left_image")[0]);var s=$(w[bfjs.selector]("img")[0]);var u=bfjs.isMobile()?w.width():s[bfjs.get_width]();var o=bfjs.isMobile()?bfjs.getOffset(w)[0]:bfjs.getOffset(w).left;var r;if(BF_STATIC.mobile_app&&BF_STATIC.os=="android"&&p==e&&u!=0){g=true}if(bfjs.isMobile()){r="rect(0px, "+(u/2)+"px, auto, 0px)";bfjs.setStyle(s,{clip:r});v.css("visibility","visible")}if(!bfjs.isMobile()){bfjs.setStyle(v,{width:u+"px"});bfjs.setStyle($(t),{width:u+"px"});Event.observe(window,"resize",function(){o=bfjs.getOffset(w).left});v[bfjs.observer]("mousemove",function(z){var x=z||window.event;var y=x.clientX-o;if((y<=u&&y>0)&&!v[bfjs.has_class]("photoslider_disabled")){d(y,w)}});v[bfjs.observer]("touchmove",function(z){z.preventDefault();var x=z.touches[0];var y=x.clientX-o;if((y<=u&&y>0)&&!v[bfjs.has_class]("photoslider_disabled")){d(y,w)}});v[bfjs.observer]("mouseout",function(z){var x=z||window.event;var y=x.clientX-o;if(y>u){d(u,w)}else{if(y<0){d(0,w)}}});v[bfjs.observer]("mouseover",function(y){var x=$(this);if(!x[bfjs.has_class]("photoslider_moused_over")){x[bfjs.add_class]("photoslider_moused_over")}if(!x[bfjs.has_class]("photoslider_viewed")&&!bfjs.isMobile()){clearTimeout(i)}});v[bfjs.observer]("touchstart",function(){var x=$(this);if(!x[bfjs.has_class]("photoslider_moused_over")){x[bfjs.add_class]("photoslider_moused_over")}if(!x[bfjs.has_class]("photoslider_viewed")&&!bfjs.isMobile()){clearTimeout(i)}})}if(bfjs.isMobile()){var q=$(v[bfjs.selector](".photoslider_fake_pane")[0]);q[bfjs.observer]("touchmove",function(z){z.preventDefault();var y=$(this);var x=z.originalEvent.touches[0];touchOffset=x.clientX-o;if(!v[bfjs.has_class]("photoslider_moused_over")){v[bfjs.add_class]("photoslider_moused_over")}if(touchOffset>h&&touchOffset<(u-2-h)){d(touchOffset,s,u,y)}});bfjs.windowEvent("orientationchange",function(x){u=w.width();r="rect(0px, "+(u/2)+"px, auto, 0px)";bfjs.setStyle(s,{clip:r});bfjs.setStyle(q,{left:"50%"})})}return v};var d=function(o,t,r,s){if(bfjs.isMobile()){var p=Math.round((o/r)*100)/100;var q="rect(0px, "+o+"px, auto, 0px)";bfjs.setStyle(t,{clip:q});bfjs.setStyle(s,{left:p*100+"%"})}else{bfjs.setStyle($(t),{width:o+"px"})}}};var bf_photoslider=new BF_Photoslider();bfjs.onPageLoad(bf_photoslider.init);function onYouTubeIframeAPIReady(){if($("video_overlay_init")){yt_player.create_player()}$H(yt_player.all_overlays).each(function(a){if(!yt_player.players[a.key]){yt_player.create_player_from(a.key)}})}var YT_Player=function(){this.player;this.players={};this.videoid;this.player_timer=false;this.overlays=[];this.all_overlays={};this.init=function(a,b){var c=window.YT||{};if(typeof a!=="undefined"){this.destroy_video(a);yt_player.all_overlays[a]=b}else{this.destroy_video()}if(!c.Player){(function(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";e.async=true;var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(e,d)})()}else{onYouTubeIframeAPIReady()}};this.create_player=function(){var c=function(d){if(d.data==1){yt_player.player.pauseVideo();c=yt_player.player_state_change}yt_player.player_state_change(d)};YT.embed_template='\u003ciframe width="250" height="350" src="" frameborder="0" allowfullscreen\u003e\u003c/iframe\u003e';yt_player.player=new YT.Player("video_overlay_yt",{height:325,width:540,videoId:yt_player.videoid,events:{onReady:function(){yt_player.load_video(yt_player.videoid);yt_player.player.playVideo()},onStateChange:function(d){c(d)}}});var a=$("video_overlay_yt");var b=a.getAttribute("src");a.setAttribute("src",b+"&wmode=opaque")};this.create_player_from=function(a){yt_player.players[a]=new YT.Player("yt_"+a,{events:{onStateChange:function(b){yt_player.player_state_change(b,a)}}})};this.destroy_video=function(a){if(a){try{yt_player.players[a].stopVideo();yt_player.players[a].destroy()}catch(b){}delete yt_player.players[a]}else{try{yt_player.player.stopVideo();yt_player.player.destroy()}catch(b){}yt_player.player=null}};this.load_video=function(){try{yt_player.player.cueVideoById(yt_player.videoid)}catch(a){}};this.player_state_change=function(c,b){state=c.data;var a={"-1":function(){console.log("unstarted")},"0":function(){console.log("video end")},"1":function(d){yt_player.set_video_intervals();console.log("play video")},"2":function(){console.log("paused")},"3":function(){console.log("buffering")},"5":function(){console.log("video cued")}};a[state](b)};this.set_video_id=function(a){yt_player.videoid=a};this.set_video_intervals=function(b){if(yt_player.player_timer){return}yt_player.player_timer=setInterval(function(){for(var c in yt_player.players){if(!yt_player.players[c].getCurrentTime){continue}a(c,yt_player.players[c].getCurrentTime(),yt_player.all_overlays[c])}if(!yt_player.player||!yt_player.player.getCurrentTime){return}a(null,yt_player.player.getCurrentTime(),yt_player.overlays)},500);function a(c,h,g){var j=c?(c+"_"):"";for(var f=g.length;f--;){var e=g[f];var d="anno_"+j+f;if(e&&h>=e.start&&h<=e.end){if(!$(d)){yt_player.add_annotation(e,f,c)}}else{if($(d)){$(d).remove()}}}}};this.clear_video_interval=function(a){if(a===undefined){for(var b in yt_player.player_timer){clearInterval(yt_player.player_timer[b])}yt_player.player_timer={}}else{clearInterval(yt_player.player_timer[a]);yt_player.player_timer[a]=null}};this.edit_annotation=function(c,b,a){var d="anno_"+(a?a+"_":"")+b;if($(d)){$(d).setStyle({top:c.top+"%",left:c.left+"%",maxWidth:Math.max(5,100-c.left)+"%"});$$("#"+d+" .video_anno_txt").each(function(e){e.innerHTML=c.text});$$("#"+d+" a").each(function(e){e.href=c.link})}yt_player.overlays[b]=c};this.add_annotation=function(d,c,b){var e={position:"absolute",top:d.top+"%",left:d.left+"%",borderRadius:"3px",padding:"5px",backgroundColor:"rgba(238, 238, 238, 0.8)",cursor:"pointer",maxWidth:Math.max(5,100-d.left)+"%",wordWrap:"break-word",lineHeight:"16px"};var f=document.createElement("div");f.className="video_anno";f.id="anno_"+(b?b+"_":"")+c;f.setStyle(e);var g=document.createElement("div");g.className="video_anno_txt";g.innerHTML=d.text;var h=document.createElement("a");h.href=d.link;h.target="_blank";h.setStyle({color:"#111"});f.appendChild(h);h.appendChild(g);var a=$(b?"video_wrapper_"+b:"video_wrapper");this.scale_anno(f,a.getWidth()/625,a.getHeight()/379);a.insert({top:f})};this.scale_anno=function(d,a,f){if(a==1&&f==1){return}var c=["mozT","msT","oT","webkitT","t"];var e={};for(var b=c.length;b--;){e[c[b]+"ransform"]="scale("+a+","+f+")";e[c[b]+"ransformOrigin"]="top left 0"}d.setStyle(e)};this.get_overlay=function(a){return yt_player.overlays[a]};this.add_overlay=function(a,b){if(typeof b!="undefined"){yt_player.overlays[b]=a;return b}return yt_player.overlays.push(a)-1};this.remove_overlay=function(d,a){if(a!==undefined){var c=yt_player.all_overlays[a][d];var b="anno_"+a+"_"+d;delete yt_player.overlays[a][d]}else{var c=yt_player.overlays[d];var b="anno_"+d;delete yt_player.overlays[d]}if($(b)){$(b).remove()}}};yt_player=new YT_Player();